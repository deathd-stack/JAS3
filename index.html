<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>JAS MEMO VER 1.2.X</title>

<style>
body{
  margin:0;
  background:#ff9f1c;
  font-family:system-ui;
  font-size:1.15rem;
  font-weight:600;
}
header{
  text-align:center;
  padding:16px;
  font-size:2.1rem;
  font-weight:900;
  cursor:pointer;
}
.controls{
  display:flex;
  gap:10px;
  justify-content:center;
}
button{
  padding:12px 16px;
  border:none;
  border-radius:12px;
  background:#fff;
  font-weight:900;
  font-size:1.3rem;
}
#memoList{padding:12px;}
.memo{
  background:#fff;
  border-radius:14px;
  padding:12px;
  margin-bottom:10px;
  display:flex;
  gap:10px;
  align-items:center;
}
.memo-title{
  font-weight:900;
  cursor:pointer;
}
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  justify-content:center;
  align-items:center;
}
.box{
  background:#fff;
  width:95%;
  max-height:90vh;
  overflow:auto;
  border-radius:16px;
  padding:16px;
}
.row{
  display:flex;
  gap:12px;
  align-items:center;
  margin-bottom:6px;
}
input{
  width:70px;
  text-align:center;
  font-weight:800;
}
.cmpt{
  display:flex;
  gap:8px;
  margin-bottom:4px;
}
.cmpt input{ width:220px; }

.red{
  color:red;
  font-weight:900;
  cursor:pointer;
}
textarea{
  width:100%;
  height:70px;
  font-weight:700;
  margin-top:6px;
}
.section-title{
  font-weight:900;
  margin-top:14px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.hidden{display:none}

/* 사진 */
#photoLayer{
  position:fixed;
  inset:0;
  background:black;
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}
#photoLayer img{
  max-width:100%;
  max-height:100%;
}
</style>
</head>

<body>

<header onclick="openPhoto()">JAS MEMO VER 1.2.X</header>

<div class="controls">
  <button onclick="newMemo()">ADD MEMO</button>
  <button onclick="deleteSelected()">DELETE</button>
  <button onclick="addPhoto()">PHOTO</button>
</div>

<div id="memoList"></div>
<input type="file" id="photoInput" accept="image/*" hidden>

<div class="modal" id="modal">
<div class="box">

<div class="row" style="justify-content:center;">
  <input type="checkbox" id="inChk"> INBOUND
  <span style="width:40px"></span>
  <input type="checkbox" id="outChk"> OUTBOUND
</div>

<div id="sections"></div>

<div class="row">
  <button onclick="saveMemo()">SAVE</button>
  <button onclick="closeModal()">CLOSE</button>
</div>

</div>
</div>

<div id="photoLayer" ondblclick="closePhoto()">
  <img id="photoImg">
</div>

<script>
let memos=JSON.parse(localStorage.getItem("jas_memos")||"[]");
let editId=null;
let photo=localStorage.getItem("jas_photo");

function now(){
 const d=new Date();
 return d.toLocaleTimeString("ko-KR",{hour12:false,hour:"2-digit",minute:"2-digit"});
}

function newMemo(){
 editId=null;
 modal.style.display="flex";
 inChk.checked=false;
 outChk.checked=false;
 sections.innerHTML="";
}

function closeModal(){ modal.style.display="none"; }

inChk.onchange=outChk.onchange=renderSections;

function renderSections(){
 sections.innerHTML="";
 if(inChk.checked) sections.innerHTML+=section("INBOUND");
 if(outChk.checked) sections.innerHTML+=section("OUTBOUND");
}

function section(type){
return `
<div class="section-title">
  ${type}
  <span class="red" onclick="this.innerText=now()">${now()}</span>
</div>

<div class="row">
<label>7C</label><input maxlength="4" data-k="${type}-c7">
<label>HL</label><input maxlength="4" data-k="${type}-hl">
</div>

${[1,2,3,4].map(i=>`
<div class="cmpt">
<label>CMPT ${i}</label>
<input data-k="${type}-cmpt${i}">
</div>`).join("")}

<div class="row">
<label>T</label><input maxlength="3" data-k="${type}-t">
<label>D</label><input maxlength="2" data-k="${type}-d">
<label>B</label><input maxlength="2" data-k="${type}-b">
</div>

<div class="row">
<label>W</label><input maxlength="2" data-k="${type}-w">
<label>C</label><input maxlength="3" data-k="${type}-c">
<label>COB</label><input maxlength="3" data-k="${type}-cob">
</div>

<textarea placeholder="특이사항 (${type})" data-k="${type}-note"></textarea>
`;
}

function saveMemo(){
 const data={id:editId??Date.now()};
 document.querySelectorAll("[data-k]").forEach(i=>data[i.dataset.k]=i.value);
 editId?memos[memos.findIndex(m=>m.id===editId)]=data:memos.push(data);
 localStorage.setItem("jas_memos",JSON.stringify(memos));
 closeModal(); renderList();
}

function renderList(){
 memoList.innerHTML="";
 memos.forEach(m=>{
 let t=[];
 if(m["INBOUND-c7"]) t.push(`IN 7C[${m["INBOUND-c7"]}] HL[${m["INBOUND-hl"]}]`);
 if(m["OUTBOUND-c7"]) t.push(`OUT 7C[${m["OUTBOUND-c7"]}] HL[${m["OUTBOUND-hl"]}]`);
 memoList.innerHTML+=`
 <div class="memo">
 <input type="checkbox">
 <div class="memo-title" onclick="editMemo(${m.id})">${t.join(" / ")}</div>
 </div>`;
 });
}

function editMemo(id){
 editId=id;
 const m=memos.find(x=>x.id===id);
 modal.style.display="flex";
 inChk.checked=!!m["INBOUND-c7"];
 outChk.checked=!!m["OUTBOUND-c7"];
 renderSections();
 document.querySelectorAll("[data-k]").forEach(i=>i.value=m[i.dataset.k]||"");
}

function deleteSelected(){
 const c=[...document.querySelectorAll(".memo input")];
 memos=memos.filter((_,i)=>!c[i].checked);
 localStorage.setItem("jas_memos",JSON.stringify(memos));
 renderList();
}

/* 사진 */
function addPhoto(){ photoInput.click(); }
photoInput.onchange=e=>{
 const f=e.target.files[0];
 if(!f)return;
 const r=new FileReader();
 r.onload=()=>{ photo=r.result; localStorage.set
